:root{
  --bg:#0b0b10;
  --panel:rgba(255,255,255,0.06);
  --line:rgba(255,255,255,0.12);

  --text:rgba(255,255,255,0.92);
  --muted:rgba(255,255,255,0.66);
  --dim:rgba(255,255,255,0.42);

  --accent:#b51f3a;
  --good:#ffd166;
  --ok:#7bdff2;
  --miss:#ff5c8a;

  --shadow:0 18px 60px rgba(0,0,0,0.55);
  --radius:18px;
}

*{box-sizing:border-box;}
html,body{height:100%;}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  color:var(--text);
  background:
    radial-gradient(1200px 700px at 70% 20%, rgba(181,31,58,0.22), transparent 60%),
    radial-gradient(900px 600px at 20% 70%, rgba(123,223,242,0.12), transparent 60%),
    var(--bg);
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}

.app{min-height:100%;display:grid;grid-template-rows:auto 1fr;}

.topbar{
  padding:calc(14px + env(safe-area-inset-top)) 16px 12px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;
}
.brand{display:flex;flex-direction:column;gap:2px;}
.logo{letter-spacing:0.16em;font-weight:900;font-size:0.95rem;}
.tag{font-size:0.78rem;color:var(--muted);letter-spacing:0.03em;}

.top-actions{display:flex;gap:10px;align-items:center;}
.icon-btn{
  border:1px solid var(--line);
  background:var(--panel);
  color:var(--text);
  border-radius:999px;
  padding:10px 12px;
  min-width:44px;min-height:44px;
  box-shadow:0 10px 30px rgba(0,0,0,0.25);
}
.icon-btn:active{transform:scale(0.98);}
.icon{font-weight:900;}

.pill-btn{
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(255,255,255,0.05);
  color:var(--muted);
  border-radius:999px;
  padding:10px 12px;
  min-height:44px;
  display:inline-flex;
  gap:8px;
  align-items:center;
}
.pill-btn:active{transform:scale(0.99);}
.pill-ico{filter:saturate(1.1);}

.stage{
  display:grid;
  grid-template-rows:auto 1fr auto;
  padding:0 16px calc(18px + env(safe-area-inset-bottom));
  gap:12px;
}

.hud{
  display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;
}
.hud-left,.hud-right{display:flex;gap:10px;flex-wrap:wrap;}

.stat{
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:14px;
  padding:10px 12px;
  min-width:96px;
  box-shadow:0 10px 30px rgba(0,0,0,0.22);
}
.stat.small{min-width:72px;padding:10px 10px;}
.label{font-size:0.65rem;letter-spacing:0.15em;color:var(--dim);}
.value{font-size:1.15rem;font-weight:900;letter-spacing:0.02em;margin-top:2px;}

.playfield{
  position:relative;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(255,255,255,0.03);
  border-radius:22px;
  overflow:hidden;
  box-shadow:0 18px 55px rgba(0,0,0,0.35);
  min-height:46vh;
}

.trail{
  position:absolute;inset:0;pointer-events:none;
  background:radial-gradient(240px 240px at var(--tx,50%) var(--ty,50%), rgba(181,31,58,0.14), transparent 60%);
  opacity:0;
  transition:opacity 220ms ease;
}
.trail.on{opacity:1;}

.target{
  width:min(56vw,320px);
  aspect-ratio:1/1;
  border-radius:999px;
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  background:
    radial-gradient(circle at 50% 50%, rgba(255,255,255,0.10), transparent 55%),
    radial-gradient(circle at 50% 50%, rgba(181,31,58,0.15), transparent 68%);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow:var(--shadow);
  overflow:hidden;
  will-change:left,top,transform;
}

.target::before{
  content:"";
  position:absolute;inset:-22%;
  background:
    radial-gradient(circle at 50% 50%, rgba(181,31,58,0.20), transparent 60%),
    radial-gradient(circle at 50% 50%, rgba(123,223,242,0.12), transparent 65%);
  opacity:0;
  transform:scale(0.9);
  transition:opacity 220ms ease, transform 220ms ease;
}
.target.pulse::before{opacity:1;transform:scale(1);}

.sweet{
  position:absolute;inset:16%;
  border-radius:999px;
  border:1px dashed rgba(255,255,255,0.22);
  opacity:0.95;
}

.ring{
  position:absolute;inset:10%;
  border-radius:999px;
  border:2px solid rgba(255,255,255,0.22);
  filter:drop-shadow(0 12px 30px rgba(0,0,0,0.45));
  transform:scale(1.25);
  opacity:0;
}
.ring-outer{border-color:rgba(181,31,58,0.60);}
.ring-inner{inset:18%;border:2px solid rgba(255,255,255,0.18);}

.core{position:absolute;inset:0;display:grid;place-items:center;gap:10px;text-align:center;}
.core-dot{
  width:12px;height:12px;border-radius:999px;background:var(--accent);
  box-shadow:0 0 0 10px rgba(181,31,58,0.12), 0 0 0 22px rgba(181,31,58,0.06);
}
.hint{
  font-size:0.7rem;letter-spacing:0.14em;color:var(--muted);
  text-transform:uppercase;
}
.judgement{
  margin-top:6px;
  font-weight:1000;
  letter-spacing:0.10em;
  font-size:1.25rem;
  min-height:1.6em;
}

.tap-ripple{
  position:absolute;
  left:50%;top:50%;
  width:8px;height:8px;border-radius:999px;
  transform:translate(-50%,-50%) scale(1);
  border:2px solid rgba(255,255,255,0.30);
  opacity:0.9;
  pointer-events:none;
  animation:ripple 520ms ease-out forwards;
}
@keyframes ripple{
  to{transform:translate(-50%,-50%) scale(18);opacity:0;}
}

.particles{position:absolute;inset:0;pointer-events:none;}
.particle{
  position:absolute;
  width:6px;height:6px;border-radius:999px;
  background:rgba(255,255,255,0.85);
  opacity:0.9;
  transform:translate(-50%,-50%);
  animation:fly 520ms ease-out forwards;
}
@keyframes fly{
  to{
    transform:translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(0.8);
    opacity:0;
  }
}

.footer{display:grid;gap:10px;}
.progress{
  height:10px;background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  border-radius:999px;overflow:hidden;
}
.bar{width:0%;height:100%;background:linear-gradient(90deg, rgba(181,31,58,0.95), rgba(123,223,242,0.75));}
.footer-row{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;}
.mini{font-size:0.78rem;color:var(--muted);}

.overlay{
  position:fixed;inset:0;
  display:grid;place-items:center;
  padding:24px 16px;
  background:rgba(0,0,0,0.62);
  backdrop-filter:blur(12px);
  z-index:50;
}
.overlay.hidden{display:none;}

.card{
  width:min(560px,100%);
  background:rgba(10,10,15,0.72);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:var(--radius);
  padding:18px 16px;
  box-shadow:var(--shadow);
}
.card h1{margin:6px 0 4px;letter-spacing:0.12em;font-size:1.25rem;}
.card h2{margin:6px 0 10px;letter-spacing:0.06em;}
.lead{color:var(--muted);line-height:1.6;margin:8px 0 14px;}
.fine{color:var(--dim);font-size:0.78rem;line-height:1.5;margin:12px 0 0;}

.row{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0;align-items:center;justify-content:space-between;}

.pill{
  flex:1;min-width:160px;
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:14px;
  padding:10px 12px;
}
.pill-label{
  font-size:0.66rem;letter-spacing:0.12em;color:var(--dim);
  text-transform:uppercase;margin-bottom:6px;
}
.select{
  width:100%;
  border-radius:12px;
  padding:10px 10px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.04);
  color:var(--text);
  outline:none;
}

.toggle{
  display:flex;gap:10px;align-items:center;
  padding:10px 12px;
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.10);
  border-radius:999px;
  color:var(--muted);
}

.primary,.secondary,.ghost{
  border-radius:14px;
  padding:12px 14px;
  font-weight:800;
  letter-spacing:0.04em;
  border:1px solid rgba(255,255,255,0.14);
  min-height:44px;
}
.primary{
  width:100%;
  background:linear-gradient(135deg, rgba(181,31,58,0.95), rgba(181,31,58,0.65));
  border-color:rgba(181,31,58,0.65);
  color:white;
  box-shadow:0 18px 40px rgba(181,31,58,0.18);
}
.secondary{flex:1;background:rgba(255,255,255,0.06);color:var(--text);}
.ghost{flex:1;background:transparent;color:var(--muted);}
.primary:active,.secondary:active,.ghost:active{transform:scale(0.99);}

.list{
  display:grid;
  gap:10px;
  margin:10px 0 6px;
}
.item{
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.05);
  border-radius:14px;
  padding:10px 12px;
  display:flex;
  justify-content:space-between;
  gap:10px;
}
.item b{letter-spacing:0.02em;}
.item .meta{color:var(--muted);font-size:0.82rem;margin-top:4px;}
.badge{
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(255,255,255,0.04);
  border-radius:999px;
  padding:8px 10px;
  color:var(--muted);
  font-weight:800;
  min-width:92px;
  text-align:center;
}

.shop-grid{
  display:grid;
  gap:10px;
  margin:10px 0 6px;
}
.shop-card{
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.05);
  border-radius:14px;
  padding:12px;
  display:flex;
  justify-content:space-between;
  gap:12px;
  align-items:center;
}
.shop-title{font-weight:900;letter-spacing:0.02em;}
.shop-desc{color:var(--muted);font-size:0.84rem;margin-top:4px;}
.shop-buy{
  border-radius:999px;
  padding:10px 12px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(255,255,255,0.04);
  color:var(--text);
  min-height:44px;
  font-weight:900;
}
.shop-buy:active{transform:scale(0.99);}

.toast{
  position:fixed;
  left:50%;
  bottom:calc(14px + env(safe-area-inset-bottom));
  transform:translateX(-50%);
  background:rgba(10,10,15,0.78);
  border:1px solid rgba(255,255,255,0.14);
  color:var(--text);
  border-radius:999px;
  padding:10px 12px;
  box-shadow:0 18px 50px rgba(0,0,0,0.45);
  opacity:0;
  pointer-events:none;
  transition:opacity 220ms ease, transform 220ms ease;
  z-index:60;
  max-width:min(92vw,520px);
  text-align:center;
}
.toast.on{opacity:1;transform:translateX(-50%) translateY(-6px);}

@media (max-width:380px){
  .stat{min-width:86px;}
  .value{font-size:1.05rem;}
  .pill-btn span:last-child{display:none;} /* чтобы кнопки не ломали topbar на маленьких экранах */
}

/* ===== Splash intro ===== */
.overlay.splash{
  background: rgba(0,0,0,0.78);
  backdrop-filter: blur(16px);
  z-index: 100; /* выше всех остальных */
}

.splash-inner{
  text-align: center;
  transform: translateY(-2px);
}

.splash-title{
  font-weight: 900;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  font-size: 1.05rem;
  color: rgba(255,255,255,0.92);
  animation: splashIn 520ms ease-out both;
}

.splash-sub{
  margin-top: 10px;
  font-size: 0.9rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.62);
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 420ms ease, transform 420ms ease;
}

.splash-sub.show{
  opacity: 1;
  transform: translateY(0);
}

.overlay.splash.fade-out{
  animation: splashOut 520ms ease-in forwards;
}

@keyframes splashIn{
  from{ opacity: 0; transform: translateY(8px) scale(0.99); filter: blur(2px); }
  to{ opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
}

@keyframes splashOut{
  from{ opacity: 1; }
  to{ opacity: 0; visibility: hidden; }
}